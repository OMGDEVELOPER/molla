{% schema %}
{
  "name": "Installers",
  "tag": "section",
  "class": "installers-section",
  "settings": [
    {
      "type": "metaobject_list",
      "metaobject_type": "installers",
      "id": "installers_list",
      "label": "Select Installers"
    }
  ],
  "presets": [
    {
      "name": "Installers",
      "category": "Metaobjects"
    }
  ]
}
{% endschema %}
{{ 'installers.css' | asset_url | stylesheet_tag }}
<section class="installer-filters">
  <div class="container">
    <form>
      <div class="select-group">
        <button class="">
          Select State<img src="https://cdn.shopify.com/s/files/1/0936/3328/2419/files/keyboard_arrow_down_1.svg?v=1754556117">
        </button>
        <ul class="state-options">
          <li>NSW</li>
          <li>QLD</li>
        </ul>
      </div>
      <div class="select-group">
        <button class="">
          Product Type<img src="https://cdn.shopify.com/s/files/1/0936/3328/2419/files/keyboard_arrow_down_1.svg?v=1754556117">
        </button>
        <ul class="product-type-options">
          <li>NSW</li>
          <li>QLD</li>
        </ul>
      </div>
      <div class="select-group">
        <button class="">
          Installer Type<img src="https://cdn.shopify.com/s/files/1/0936/3328/2419/files/keyboard_arrow_down_1.svg?v=1754556117">
        </button>
        <ul class="installer-type-options">
          <li>NSW</li>
          <li>QLD</li>
        </ul>
      </div>
      <div class="submit-filter">
        <button class="">Filter</button>
      </div>
    </form>
  </div>
</section>
<div class="grid grid-cols-3 container">
  {% for item in section.settings.installers_list %}
    <div class="item">
      <div class="featured-img">
        <img src="https://cdn.shopify.com/s/files/1/0936/3328/2419/files/Image_3.png?v=1756290740">
      </div>
      <div class="installer-details">
        <div class="title">{{ item.title }}</div>
        <div class="tags">
          {% for tag in item.tags.value %}
            <span class="tag">{{ tag }}</span>
            {%- unless forloop.last %}, {% endunless %}
          {% endfor %}
        </div>
        <div class="details">
          <ul>
            <li>
              <img src="https://cdn.shopify.com/s/files/1/0936/3328/2419/files/location_on.png?v=1754363429">
              <span>{{ item.address }}</span>
            </li>
            <li>
              <img src="https://cdn.shopify.com/s/files/1/0936/3328/2419/files/mail.png?v=1754363429">
              <span
                ><a href="mailto:{{ item.email }}">{{ item.email }}</a></span
              >
            </li>
            <li>
              <img src="https://cdn.shopify.com/s/files/1/0936/3328/2419/files/call.png?v=1754363436">
              <span
                ><a href="tel:{{ item.phone }}">{{ item.phone }}</a></span
              >
            </li>
          </ul>
        </div>
        <div class="specialization">
          <div class="title">Specialization</div>
          <ul>
            {% for specialization in item.specialization.value %}
              <li class="">{{ specialization }}</li>
            {% endfor %}
          </ul>
        </div>
        <div class="cta">
          <a href="{{ item.request_quote_link.value }}"><button class="request-a-quote">Request a Quote</button></a>
          <a href="/pages/installers/{{ item.title | handleize  }}"><button class="view-details">View Details</button></a>
        </div>
      </div>
    </div>
  {% endfor %}
</div>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const selectGroups = document.querySelectorAll('.select-group');

    selectGroups.forEach((group) => {
      const button = group.querySelector('button');
      const options = group.querySelector('ul');

      // Toggle dropdown on button click
      button.addEventListener('click', function (e) {
        e.preventDefault();
        // Close all other dropdowns
        document.querySelectorAll('.select-group ul').forEach((ul) => {
          if (ul !== options) ul.classList.remove('show');
        });
        // Toggle current dropdown
        options.classList.toggle('show');
      });

      // Update button text on option click
      options.querySelectorAll('li').forEach((li) => {
        li.addEventListener('click', function () {
          button.childNodes[0].nodeValue = this.textContent;
          options.classList.remove('show');
        });
      });
    });

    // Optional: close dropdown if clicked outside
    document.addEventListener('click', function (e) {
      if (!e.target.closest('.select-group')) {
        document.querySelectorAll('.select-group ul').forEach((ul) => {
          ul.classList.remove('show');
        });
      }
    });
  });
</script>
