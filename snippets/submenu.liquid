{% style %}
  .submenu__items,
  .submenu-subitems {
    list-style: none;
    margin: 0;
    padding: 0;
  }

  .submenu__items > li,
  .submenu-subitems > li {
    /* position: relative; */
  }

  .submenu-subitems,
  .style-2,
  .submenu-subitems-inner {
    /* display: none; */
    position: absolute;
    top: 0;
    left: 100%;
    background: white;
    padding: 1rem;
    min-width: 220px;
    z-index: 10;
  }

  .submenu__items > li:hover > .style-2,
  .style-2 .submenu__items > li:hover > .submenu-subitems {
    /* display: block; */
  }

  .submenu-subitems-inner {
    left: 100%;
    top: 0;
  }

  /* Add transition for smoothness */
  .style-2,
  .submenu-subitems,
  .submenu-subitems-inner {
    transition: opacity 0.2s ease, visibility 0.2s ease;
  }
  .uppercase{
    text-transform:uppercase;
  }
{% endstyle %}
<submenu>
  <div class="submenu submenu-container container {{ block.id }}" id="{{ block.id }}">
    <div class="row">
                <div class="col-12 col-md-3 item item__1">
            <div class="item__1__group">
              <div class="submenu__heading">
                  <h3>OUR PRODUCTS</h3>
              </div>
              <ul class="submenu__items">
                   <li target-id="{{ block.settings.item-1-label }}-{{ block.id }}" submenu-items="{{ block.settings.menu-item-1 }}"><a href="#">{{ block.settings.item-1-label }}</a></li>
                  <li target-id="{{ block.settings.item-2-label }}-{{ block.id }}"><a href="#">{{ block.settings.item-2-label }}</a></li>
            
              </ul>
            </div>
            <ul class="submenu__items links-with-icon">
              <li><a href="#"><span class="__icon"><img src="https://cdn.shopify.com/s/files/1/0859/1186/3592/files/sell.svg?v=1752660278" alt="icon"></span><span class="__label">Special Offers</span></a></li>
              <li><a href="#"><span class="__icon"><img src="https://cdn.shopify.com/s/files/1/0859/1186/3592/files/sell.svg?v=1752660278" alt="icon"></span><span class="__label">Special Offers</span></a></li>
              <li><a href="#"><span class="__icon"><img src="https://cdn.shopify.com/s/files/1/0859/1186/3592/files/sell.svg?v=1752660278" alt="icon"></span><span class="__label">Special Offers</span></a></li>
             
            </ul>
        </div>
       {% comment %}
         
       {% endcomment %}
       <div id="render-submenus"></div>
    </div>
  </div>
</submenu>
<script>
  window.menuData = {};

  {% assign menu_handles = "" | split: "" %}
  {% if block.settings.menu-item-1 != blank %}
    {% assign menu_handles = menu_handles | push: block.settings.menu-item-1 %}
  {% endif %}
  {% if block.settings.menu-item-2 != blank %}
    {% assign menu_handles = menu_handles | push: block.settings.menu-item-2 %}
  {% endif %}
  const menuHandles = {{ menu_handles | json }};
  console.log("Menu Handles:", menuHandles);
  {% for menu_handle in menu_handles %}
    window.menuData["{{ menu_handle }}"] = {
      title: "{{ menu_handle }}",
      items: [
        {% assign main_menu = linklists[menu_handle] %}
        {% for top_link in main_menu.links %}
          {
            title: "{{ top_link.title | escape }}",
            url: "{{ top_link.url }}",
            children: [
              {% for child_link in top_link.links %}
                {
                  title: "{{ child_link.title | escape }}",
                  url: "{{ child_link.url }}",
                  children: [
                    {% for subchild_link in child_link.links %}
                      {
                        title: "{{ subchild_link.title | escape }}",
                        url: "{{ subchild_link.url }}"
                      }{% unless forloop.last %},{% endunless %}
                    {% endfor %}
                  ]
                }{% unless forloop.last %},{% endunless %}
              {% endfor %}
            ]
          }{% unless forloop.last %},{% endunless %}
        {% endfor %}
      ]
    };
  {% endfor %}
</script>


{% javascript %}
document.addEventListener('DOMContentLoaded', () => {
  const menus = window.menuData;
  console.log(menus)

  function renderSubmenu(menu) {
    let html = `
      <div class="col-12 col-md-3 item item__2 w-300px level-2">
        <div class="item__1__group">
          <div class="submenu__heading heading__1">
            <h3 class="uppercase">${menu.title}</h3>
          </div>
          <ul class="submenu__items level-2">
    `;

    menu.items.forEach(top => {
      html += `
        <li class="has-second-level style-2-li">
          <a href="${top.url}">${top.title}</a>
      `;

      if (top.children && top.children.length > 0) {
        html += `
          <div class="submenu-items-container submenu-item__item style-2 level-3 w-300px">
            <div class="submenu__heading"><h3>${top.title}</h3></div>
            <ul class="submenu__items item">
        `;

        top.children.forEach(child => {
          html += `<li class="has-third-level"><a href="${child.url}">${child.title}</a>`;

          if (child.children && child.children.length > 0) {
            html += `
              <ul class="submenu-subitems-inner item level-4 w-300px submenu-items-container submenu-item__item">
                <div class="submenu__heading"><h3>${child.title}</h3></div>
            `;
            child.children.forEach(sub => {
              html += `<li class="menu-item-last-child"><a href="${sub.url}">${sub.title}</a></li>`;
            });
            html += `</ul>`;
          }

          html += `</li>`;
        });

        html += `</ul></div>`;
      }

      html += `</li>`;
    });

    html += `</ul></div></div>`;
    return html;
  }

  // document.getElementById('render-submenus').innerHTML = renderSubmenu(menu);
  let menuItems = document.querySelectorAll('#render-submenus li');
  menuItems.forEach((item)=>{
    item.addEventListener('click',function(){
    // resetSubmenu()
     const submenu = item.querySelector('.submenu-items-container');
      submenu.style.display ="block";
    })
  })
  function resetSubmenu(){
    menuItems.forEach((item)=>{
     item.style.display ="none";
    })
  }
});

{% endjavascript %}
<script>
  document.querySelectorAll('.has-second-level').forEach(item => {
    let timer;

    item.addEventListener('mouseenter', () => {
      clearTimeout(timer);
      const submenu = item.querySelector('.style-2');
      submenu && (submenu.style.display = 'block');
    });

    item.addEventListener('mouseleave', () => {
      const submenu = item.querySelector('.style-2');
      timer = setTimeout(() => {
        submenu && (submenu.style.display = 'none');
      }, 300); // delay in ms
    });
  });

  document.querySelectorAll('.has-third-level').forEach(item => {
    let timer;

    item.addEventListener('mouseenter', () => {
      clearTimeout(timer);
      const submenu = item.querySelector('.submenu-subitems-inner');
      submenu && (submenu.style.display = 'block');
    });

    item.addEventListener('mouseleave', () => {
      const submenu = item.querySelector('.submenu-subitems-inner');
      timer = setTimeout(() => {
        submenu && (submenu.style.display = 'none');
      }, 300);
    });
  });
</script>


